"use strict";(self.webpackChunkcipp_docs=self.webpackChunkcipp_docs||[]).push([[6460],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return p}});var a=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,i=e.originalType,l=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),h=c(n),p=s,g=h["".concat(l,".").concat(p)]||h[p]||u[p]||i;return n?a.createElement(g,r(r({ref:t},d),{},{components:n})):a.createElement(g,r({ref:t},d))}));function p(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var i=n.length,r=new Array(i);r[0]=h;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:s,r[1]=o;for(var c=2;c<i;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},2519:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return d},toc:function(){return u},default:function(){return g}});var a,s=n(7462),i=n(3366),r=(n(7294),n(3905)),o=["components"],l={id:"bestpracticeanalyser",title:"Best Practice Analyser",description:"Audit your tenant against best practices.",slug:"/usingcipp/tenantadministration/bestpracticeanalyser"},c=void 0,d={unversionedId:"usingcipp/tenantadministration/bestpracticeanalyser",id:"usingcipp/tenantadministration/bestpracticeanalyser",title:"Best Practice Analyser",description:"Audit your tenant against best practices.",source:"@site/docs/user/usingcipp/tenantadministration/bestpracticeanalyser.mdx",sourceDirName:"usingcipp/tenantadministration",slug:"/usingcipp/tenantadministration/bestpracticeanalyser",permalink:"/docs/user/usingcipp/tenantadministration/bestpracticeanalyser",editUrl:"https://github.com/KelvinTegelaar/CIPP/tree/docs/docs/user/usingcipp/tenantadministration/bestpracticeanalyser.mdx",tags:[],version:"current",lastUpdatedBy:"Michael O'Toole",lastUpdatedAt:1644777269,formattedLastUpdatedAt:"13/02/2022",frontMatter:{id:"bestpracticeanalyser",title:"Best Practice Analyser",description:"Audit your tenant against best practices.",slug:"/usingcipp/tenantadministration/bestpracticeanalyser"},sidebar:"userSidebar",previous:{title:"Standards",permalink:"/docs/user/usingcipp/tenantadministration/standards"},next:{title:"Domains Analyser",permalink:"/docs/user/usingcipp/tenantadministration/domainsanalyser"}},u=[{value:"Getting Started",id:"getting-started",children:[],level:2},{value:"Refreshing / Generating the Data",id:"refreshing--generating-the-data",children:[],level:2},{value:"Interpreting Results",id:"interpreting-results",children:[],level:2},{value:"The Standards",id:"the-standards",children:[{value:"Unified Audit Log Enabled",id:"unified-audit-log-enabled",children:[],level:3},{value:"Security Defaults Enabled",id:"security-defaults-enabled",children:[],level:3},{value:"Message Copy for Sent As",id:"message-copy-for-sent-as",children:[],level:3},{value:"User Can&#39;t Consent to Apps",id:"user-cant-consent-to-apps",children:[],level:3},{value:"Passwords don&#39;t Expire",id:"passwords-dont-expire",children:[],level:3},{value:"Privacy in Reports Enabled",id:"privacy-in-reports-enabled",children:[],level:3},{value:"Self-Service Password Reset Enabled",id:"self-service-password-reset-enabled",children:[],level:3},{value:"Modern Auth Enabled",id:"modern-auth-enabled",children:[],level:3},{value:"Shared Mailboxes Logins Not Enabled",id:"shared-mailboxes-logins-not-enabled",children:[],level:3},{value:"Unused Licenses",id:"unused-licenses",children:[],level:3}],level:2},{value:"Common Problems",id:"common-problems",children:[],level:2},{value:"Feature Requests / Ideas",id:"feature-requests--ideas",children:[],level:2},{value:"Known Issues / Limitations",id:"known-issues--limitations",children:[],level:2}],h=(a="OtherIssues",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",e)}),p={toc:u};function g(e){var t=e.components,n=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,s.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The Best Practice Analyser is a series of checks that run on all your 365 tenants. The best practice idea of this has been widely discussed with many MSPs. Most of these best practices derive from the standards in CIPP. The Best Practice Analyser is entirely read only. It makes no changes to your tenants."),(0,r.kt)("h2",{id:"getting-started"},"Getting Started"),(0,r.kt)("p",null,"In the left hand menu, navigate to ",(0,r.kt)("strong",{parentName:"p"},"Tenant Administration > Standards > Best Practice Analyser"),". If this is your first ever run you may see an error initially because there is no data, you can wait for the automatic daily job that generates the data."),(0,r.kt)("h2",{id:"refreshing--generating-the-data"},"Refreshing / Generating the Data"),(0,r.kt)("p",null,"At the top of the page there is button called ",(0,r.kt)("strong",{parentName:"p"},"Force Refresh All Data"),". You should only use this once."),(0,r.kt)("h2",{id:"interpreting-results"},"Interpreting Results"),(0,r.kt)("p",null,"The reporting here follows a standard colour theme. Red is bad and not something that should be happening on your tenant. Orange is either a warning or subjective. It doesn't necessarily indicate something is wrong. Green means there are no issues or the setting's configured in a manner that's meets the best practice."),(0,r.kt)("h2",{id:"the-standards"},"The Standards"),(0,r.kt)("p",null,"Below is a list of the standards that are currently implemented:"),(0,r.kt)("h3",{id:"unified-audit-log-enabled"},"Unified Audit Log Enabled"),(0,r.kt)("p",null,"This best practice checks that on your tenants that the Unified Audit Log's enabled. The Unified Audit Log is Microsoft 365's primary logging for user, group, application, domain and, directory activities."),(0,r.kt)("p",null,"You should have the Unified Audit Log enabled on your tenant."),(0,r.kt)("h3",{id:"security-defaults-enabled"},"Security Defaults Enabled"),(0,r.kt)("p",null,"This best practice is a check to see if Security Defaults' enabled. Security Defaults refers to Microsoft's pre-configured security settings that applied to tenants to enable MFA, block legacy authentication protocols and more."),(0,r.kt)("p",null,"Whether to enable security defaults or not is subjective, which is why not having security defaults enabled triggers an orange warning status."),(0,r.kt)("h3",{id:"message-copy-for-sent-as"},"Message Copy for Sent As"),(0,r.kt)("p",null,"You can select the badge in this column to view individual accounts where Message Copy for Sent As isn't enabled. This checks that sent items are automatically saved in the shared or delegated mailbox."),(0,r.kt)("p",null,"Access to mailboxes in Microsoft 365 can delegated to other people to enable delegates to access the mailbox and send mail as them. These people are often called the delegate and the delegator, respectively."),(0,r.kt)("p",null,"In this example the delegator is manager and the delegate is assistant. When an assistant has access to a manager's mailbox, it's called delegated access. People often set up delegated access and send permissions to let an assistant to manage a manager's calendar where they have to send and respond to meeting requests. When an assistant sends mail as, or on behalf of, a manager, the sent message goes to sent items in the assistant's mailbox and not in the managers'. It's possible to set it so that the manager gets it put in to their sent items too."),(0,r.kt)("p",null,"This best practice is a check to see if those who have send as / on behalf permissions store sent mails in the delegator's mailbox."),(0,r.kt)("p",null,"Whether to enable message copy for sent as or not is subjective, which is why not having message copy for sent as triggers an orange warning status."),(0,r.kt)("h3",{id:"user-cant-consent-to-apps"},"User Can't Consent to Apps"),(0,r.kt)("p",null,"This best practice checks whether users can give consent to apps that use OpenID Connect and / or OAuth for sign-in and requests to access data. Applications originate from a variety of sources, created in your own organization, from another Office 365 organization or, public / created by third-party vendors. It's best practice that users shouldn't be able to give consent to apps without administrator review."),(0,r.kt)("p",null,"Users being able to consent to applications triggers a red danger status as this represents a security risk you should mitigate."),(0,r.kt)("h3",{id:"passwords-dont-expire"},"Passwords don't Expire"),(0,r.kt)("p",null,"This setting is checking whether the tenant has set passwords to expire or not. Current research strongly indicates that mandated password changes do more harm than good. Both the ",(0,r.kt)("a",{parentName:"p",href:"https://www.ncsc.gov.uk/blog-post/problems-forcing-regular-password-expiry"},"United Kingdom's National Cyber Security Centre (NCSC)")," and the ",(0,r.kt)("a",{parentName:"p",href:"https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-63-3.pdf"},"United States' National Institute of Standards and Technology (NIST)")," recommend that timed password expiry isn't used."),(0,r.kt)("p",null,"Having password expiry configured triggers a red danger status as this represents a security risk you should mitigate."),(0,r.kt)("h3",{id:"privacy-in-reports-enabled"},"Privacy in Reports Enabled"),(0,r.kt)("p",null,"A number of the reports that pre-generate in Microsoft 365 contain personally identifiable information (like a users name). In 2021 ",(0,r.kt)("a",{parentName:"p",href:"https://techcommunity.microsoft.com/t5/microsoft-365-blog/privacy-changes-to-microsoft-365-usage-analytics/ba-p/2694137"},"Microsoft announced")," that they were pseudonymising user-level information by default across many Microsoft 365 reports and APIs. Microsoft implemented this change to protect user privacy and help companies comply with various local privacy laws."),(0,r.kt)("p",null,"Having this setting enabled can make reporting difficult. For the sake of more exact reporting information, which provides many security benefits it's recommended that you don't have this enabled."),(0,r.kt)("p",null,"Whether to enable privacy in reports or not is subjective, which is why having privacy in reports triggers an orange warning status."),(0,r.kt)("h3",{id:"self-service-password-reset-enabled"},"Self-Service Password Reset Enabled"),(0,r.kt)("p",null,"Microsoft 365 has an organisational setting that when enabled, provides the ability for users to reset their own passwords through a forgot your password process with strong authentication requirements. This check has three possible results. "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Self-service password reset is off for all users"),(0,r.kt)("li",{parentName:"ul"},"Self-service password reset is on for all users"),(0,r.kt)("li",{parentName:"ul"},"Self-service password reset is on for specific users.")),(0,r.kt)("p",null,"Whether to enable self-service password reset or not is subjective, which is why not having self service password resets enabled triggers an orange warning status."),(0,r.kt)("h3",{id:"modern-auth-enabled"},"Modern Auth Enabled"),(0,r.kt)("p",null,"Modern authentication is a core security feature of Microsoft 365 and provides authentication features like MFA, smart cards, third-party authentication providers using Security Assertion Markup Language (SAML)."),(0,r.kt)("p",null,"Not having modern authentication enabled triggers a red danger status."),(0,r.kt)("h3",{id:"shared-mailboxes-logins-not-enabled"},"Shared Mailboxes Logins Not Enabled"),(0,r.kt)("p",null,"You can select the badge in this column to view shared mailbox accounts with login enabled. "),(0,r.kt)("p",null,"This setting is checking to see if you have shared mailboxes attached to a valid account that can still login. Usually shared mailboxes shouldn't have a  account attached to them with an active login. Commonly when a user leaves a business, they're converted from a licensed user account to a shared mailbox, with the license removed to save money. Often this still leaves an active account linked to the shared mailbox, even with the password changed this increases risk. "),(0,r.kt)("p",null,"Having shared mailboxes with enabled accounts triggers a red danger status."),(0,r.kt)("h3",{id:"unused-licenses"},"Unused Licenses"),(0,r.kt)("p",null,"You can select the badge in this column to view unused licenses."),(0,r.kt)("p",null,"This checks all licenses in every tenant and compares the purchased number with the number consumed. Where there is a difference in this number this is normally because you have licenses that you are paying for, but aren't utilising."),(0,r.kt)("p",null,"This excludes certain commonly under-utilised licenses, for example free licenses or trials."),(0,r.kt)("p",null,"For more licenses / SKUs you think should added to this checks' exclusions please raise a ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/KelvinTegelaar/CIPP/issues/new?assignees=&labels=&template=feature_request.md&title=FEATURE+REQUEST%3A+"},"feature request")," in GitHub."),(0,r.kt)("p",null,"Having unused licenses triggers an orange warning status."),(0,r.kt)("h2",{id:"common-problems"},"Common Problems"),(0,r.kt)("p",null,"You must give adequate time for the best practice Analyser to run. In an environment with 100 tenants this takes on average 15 minutes. "),(0,r.kt)("p",null,"Check that your permissions are correct by navigating to ",(0,r.kt)("strong",{parentName:"p"},"CIPP Settings > Configuration Settings > Run Permission Check"),"."),(0,r.kt)("p",null,"Make sure both CIPP-API and CIPP are fully up-to-date. There is extensive logging in the log files in the CIPP-API Function App."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Partial Data")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If you are only seeing partial data after waiting a while for the data to populate, it's likely an issue with your Exchange Refresh Token used across the analyser."),(0,r.kt)("p",{parentName:"div"},"You can test this with the Access Check by navigating to ",(0,r.kt)("strong",{parentName:"p"},"CIPP Settings > Configuration Settings > Tenant Access Check"),"."))),(0,r.kt)("h2",{id:"feature-requests--ideas"},"Feature Requests / Ideas"),(0,r.kt)("p",null,"Please raise any ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/KelvinTegelaar/CIPP/issues/new?assignees=&labels=&template=feature_request.md&title=FEATURE+REQUEST%3A+"},"feature requests")," on GitHub."),(0,r.kt)("h2",{id:"known-issues--limitations"},"Known Issues / Limitations"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Currently the best practice analyser runs every day at 3 AM and has a significant impact on the overall performance of CIPP for about 30 minutes.")),(0,r.kt)(h,{mdxType:"OtherIssues"}))}g.isMDXComponent=!0}}]);